<div class="min-h-screen">
  <div
    class="max-w-7xl mx-auto mt-6 p-4 bg-black rounded-lg text-green-400 font-sans min-h-[80vh] shadow-lg px-6"
  >
    <h2 class="text-3xl font-bold mb-6 border-b border-green-600 pb-2">
      Gestión de Comentarios
    </h2>

    <!-- Selector de Producto -->
    <div class="mb-4 flex items-center gap-4 flex-wrap">
    <label for="productoSelect" class="font-semibold">Seleccionar Producto:</label>
    <select
        id="productoSelect"
        [(ngModel)]="productoId"
        (change)="onProductoChange()"
        class="bg-green-900 text-green-200 rounded-md px-3 py-1 border border-green-600 focus:outline-none focus:ring-2 focus:ring-green-500"
    >
        <option *ngFor="let prod of productos" [value]="prod.id">{{ prod.nombre }}</option>
    </select>


      <!-- Selector de Orden -->
      <label for="ordenSelect" class="font-semibold ml-6">Ordenar por:</label>
      <select
        id="ordenSelect"
        (change)="onOrdenChange($event)"
        class="bg-green-900 text-green-200 rounded-md px-3 py-1 border border-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 cursor-pointer"
      >
        <option value="fecha">Fecha (más reciente)</option>
        <option value="likes">Likes (mayores primero)</option>
        <option value="dislikes">Dislikes (mayores primero)</option>
        <option value="usuario">Usuario (A-Z)</option>
      </select>
    </div>

    <div
      *ngIf="loading"
      class="bg-green-800 text-green-300 p-3 rounded mb-4"
    >
      Cargando comentarios...
    </div>
    <div
      *ngIf="errorMessage"
      class="bg-red-900 text-red-400 p-3 rounded mb-4"
    >
      {{ errorMessage }}
    </div>

    <table
      *ngIf="comentarios.length > 0"
      class="w-full text-left border-collapse rounded-lg overflow-hidden"
    >
      <thead>
        <tr class="bg-green-900">
            <th class="py-2 px-4 rounded-tl-lg">Usuario</th>
            <th class="py-2 px-4">Contenido</th>
            <th class="py-2 px-4">Likes</th>
            <th class="py-2 px-4">Dislikes</th>
            <th class="py-2 px-4">Fecha</th>
            <th class="py-2 px-4 rounded-tr-lg">Acciones</th>
        </tr>
        </thead>

      <tbody>
        <tr
          *ngFor="let c of comentarios"
          class="border-b border-green-700 hover:bg-green-800 transition-colors"
        >
          <td class="py-2 px-4">{{ c.usuario }}</td>
          <td class="py-2 px-4 break-words max-w-xs">{{ c.contenido }}</td>
          <td class="py-2 px-4">{{ c.likes === null ? '-' : c.likes }}</td>
          <td class="py-2 px-4">{{ c.dislikes === null ? '-' : c.dislikes }}</td>
          <td class="py-2 px-4">{{ c.fecha | date : 'short' }}</td>
          <td class="py-2 px-4 flex gap-2">
            <button
              class="bg-green-700 hover:bg-green-600 disabled:bg-gray-700 text-black rounded px-3 py-1 transition"
              (click)="responderComentario(c.id)"
              [disabled]="c.contenido.toLowerCase().includes('eliminado')"
            >
              Responder
            </button>
            <button
              class="bg-red-700 hover:bg-red-600 text-black rounded px-3 py-1 transition"
              (click)="eliminarComentario(c.id)"
            >
              Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div
      *ngIf="!loading && comentarios.length === 0"
      class="bg-yellow-800 text-yellow-400 p-3 rounded mt-4"
    >
      No hay comentarios para mostrar.
    </div>
  </div>
</div>